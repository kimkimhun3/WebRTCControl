â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  INTEGRATING WITH YOUR EXISTING AUTOSTART.SH                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ YOUR CURRENT AUTOSTART.SH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your existing autostart.sh handles:
   âœ“ Apache2 web server setup
   âœ“ API keys copying
   âœ“ PHP initialization
   âœ“ File permissions

Location: /media/card/autostart.sh (presumably)


ğŸ¯ RECOMMENDED APPROACH: MODULAR SCRIPTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Keep scripts separate and organized:

/media/card/
â”œâ”€â”€ autostart.sh                    â† Your main boot script (updated)
â”‚
â””â”€â”€ WebRTCControl/
    â”œâ”€â”€ start_webrtccontrol.sh      â† NEW: Starts WebControlServer
    â”œâ”€â”€ stop_webrtccontrol.sh       â† NEW: Stops WebControlServer
    â”œâ”€â”€ WebControlServer            â† The control server binary
    â”œâ”€â”€ StreamingProgram            â† The streaming server binary
    â”œâ”€â”€ turnserver
    â”œâ”€â”€ temp.conf
    â””â”€â”€ control-panel.html


ğŸ“ FILES PROVIDED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. start_webrtccontrol.sh
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â€¢ Starts WebControlServer
   â€¢ Saves PID to /tmp/webcontrol.pid
   â€¢ Checks if startup was successful
   â€¢ Displays status message

2. stop_webrtccontrol.sh
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â€¢ Stops WebControlServer gracefully
   â€¢ Cleans up PID file
   â€¢ Forces kill if necessary

3. autostart_merged.sh
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â€¢ Your existing Apache/PHP startup
   â€¢ PLUS WebRTC Control Server startup
   â€¢ Ready to replace your current autostart.sh


ğŸ”§ INSTALLATION STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Step 1: Backup your current autostart.sh
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   cp /media/card/autostart.sh /media/card/autostart.sh.backup

Step 2: Copy the new scripts
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   # Copy to WebRTCControl folder:
   cp start_webrtccontrol.sh /media/card/WebRTCControl/
   cp stop_webrtccontrol.sh /media/card/WebRTCControl/
   
   # Make them executable:
   chmod +x /media/card/WebRTCControl/start_webrtccontrol.sh
   chmod +x /media/card/WebRTCControl/stop_webrtccontrol.sh

Step 3: Update your main autostart.sh
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Option A - Use the merged version:
      cp autostart_merged.sh /media/card/autostart.sh
      chmod +x /media/card/autostart.sh
   
   Option B - Manually add to your existing file:
      nano /media/card/autostart.sh
      
      # Add these lines at the END (before "echo autostart.sh Complete"):
      
      if [ -f "$SD_PATH/WebRTCControl/start_webrtccontrol.sh" ]; then
          echo "Starting WebRTC Control Server..."
          sh $SD_PATH/WebRTCControl/start_webrtccontrol.sh
      else
          echo "WARNING: WebRTC Control Server startup script not found"
      fi

Step 4: Test the startup script
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   # Test manually before rebooting:
   sh /media/card/WebRTCControl/start_webrtccontrol.sh
   
   # Check if it's running:
   ps aux | grep WebControlServer
   
   # Access control panel:
   # Open browser: http://YOUR_IP:8080/

Step 5: Reboot to test autostart
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   reboot
   
   # After boot, check:
   ps aux | grep WebControlServer
   cat /tmp/webcontrol.pid


ğŸ“‚ FINAL FOLDER STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/media/card/
â”‚
â”œâ”€â”€ autostart.sh                       â† Your updated main boot script
â”œâ”€â”€ autostart.sh.backup                â† Your original (backup)
â”‚
â”œâ”€â”€ web/                               â† Your existing web files
â”‚   â””â”€â”€ initialize.php
â”‚
â”œâ”€â”€ *.pem                              â† Your API keys
â”‚
â””â”€â”€ WebRTCControl/                     â† WebRTC control system
    â”œâ”€â”€ start_webrtccontrol.sh         â† Start script
    â”œâ”€â”€ stop_webrtccontrol.sh          â† Stop script
    â”œâ”€â”€ WebControlServer               â† Control server (compiled)
    â”œâ”€â”€ StreamingProgram               â† Streaming server (compiled)
    â”œâ”€â”€ turnserver                     â† TURN server
    â”œâ”€â”€ temp.conf                      â† TURN config
    â””â”€â”€ control-panel.html             â† Web interface


ğŸš€ STARTUP SEQUENCE (AFTER INTEGRATION)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BOOT
 â”‚
 â””â”€â–º /media/card/autostart.sh runs
      â”‚
      â”œâ”€â–º 1. Apache2 setup
      â”‚    â”œâ”€â–º Copy API keys
      â”‚    â”œâ”€â–º Set permissions
      â”‚    â””â”€â–º Restart Apache
      â”‚
      â”œâ”€â–º 2. PHP initialization
      â”‚    â””â”€â–º Run initialize.php
      â”‚
      â”œâ”€â–º 3. Apache restart
      â”‚
      â””â”€â–º 4. WebRTC Control Server startup (NEW!)
           â””â”€â–º Calls start_webrtccontrol.sh
                â”‚
                â”œâ”€â–º Changes to /media/card/WebRTCControl
                â”œâ”€â–º Starts ./WebControlServer
                â”œâ”€â–º Saves PID to /tmp/webcontrol.pid
                â””â”€â–º WebControlServer running on port 8080


ğŸ” VERIFICATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After boot, check if everything is running:

1. Check Apache:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ps aux | grep apache
   curl http://localhost/

2. Check WebRTC Control Server:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ps aux | grep WebControlServer
   cat /tmp/webcontrol.pid
   curl http://localhost:8080/api/status

3. Access control panel:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Browser: http://YOUR_IP:8080/


ğŸ›‘ STOPPING THE WEBRTC CONTROL SERVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Manual stop:
   sh /media/card/WebRTCControl/stop_webrtccontrol.sh

Or direct kill:
   kill $(cat /tmp/webcontrol.pid)


ğŸ”„ RESTARTING WEBRTC CONTROL SERVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   # Stop it
   sh /media/card/WebRTCControl/stop_webrtccontrol.sh
   
   # Start it again
   sh /media/card/WebRTCControl/start_webrtccontrol.sh


âš ï¸ IMPORTANT NOTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Scripts use /bin/sh (not bash) - compatible with embedded systems
âœ… No dependencies on bash-specific features
âœ… Minimal resource usage
âœ… Error checking included
âœ… PID file management for easy process control

âš ï¸ Port 8080 must be available:
   â€¢ If Apache uses port 8080, change WebControlServer to different port
   â€¢ Or change Apache to different port
   â€¢ Current setup assumes Apache uses port 80 (default)

âš ï¸ Make sure WebControlServer is executable:
   chmod +x /media/card/WebRTCControl/WebControlServer


ğŸ¯ ALTERNATIVE: SIMPLE INLINE ADDITION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If you don't want separate scripts, add directly to your autostart.sh:

   #!/bin/sh
   SD_PATH=/media/card
   
   # ... your existing Apache/PHP code ...
   
   echo "Apache/PHP startup complete!"
   
   # Start WebRTC Control Server
   cd $SD_PATH/WebRTCControl
   ./WebControlServer &
   echo $! > /tmp/webcontrol.pid
   echo "WebRTC Control Server started (PID: $(cat /tmp/webcontrol.pid))"
   
   echo "autostart.sh Complete !!"


ğŸ“Š TESTING CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Before rebooting:
   â˜ Backup original autostart.sh
   â˜ Copy scripts to correct locations
   â˜ Make scripts executable (chmod +x)
   â˜ Test start script manually
   â˜ Verify control panel accessible
   â˜ Test stop script

After rebooting:
   â˜ Check if WebControlServer is running (ps aux)
   â˜ Check PID file exists (/tmp/webcontrol.pid)
   â˜ Access control panel (http://IP:8080/)
   â˜ Test starting streaming
   â˜ Test stopping streaming
   â˜ Test TURN server control


ğŸ’¡ TIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ Keep logs: Redirect output to log file
  ./WebControlServer > /tmp/webcontrol.log 2>&1 &

â€¢ Monitor startup: Check system logs
  dmesg | grep -i webrtc

â€¢ Debug mode: Run manually first before adding to autostart
  cd /media/card/WebRTCControl
  ./WebControlServer

â€¢ Network check: Ensure network is up before starting
  while ! ping -c 1 8.8.8.8; do sleep 1; done


âœ… YOU'RE READY!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Files to use:
   1. start_webrtccontrol.sh     â†’ /media/card/WebRTCControl/
   2. stop_webrtccontrol.sh      â†’ /media/card/WebRTCControl/
   3. autostart_merged.sh        â†’ /media/card/autostart.sh (or add manually)

Your choice:
   Option A: Use autostart_merged.sh (complete replacement)
   Option B: Add the WebRTC section to your existing autostart.sh

Both options work perfectly! ğŸš€
